# -*- coding: utf-8 -*-
"""dashboard.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NNcxLVil_kwNNiqbSwnWAR6v0NprI4K6
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import streamlit as st
sns.set(style='dark')

#Mengambil data dari file
day_df = pd.read_csv("day.csv")

#Mengubah nama kolom
day_df.rename(columns={
    'dteday': 'tanggal',
    'yr': 'tahun',
    'mnth': 'bulan',
    'weathersit': 'cuaca',
    'cnt': 'jumlah pengguna total'
}, inplace=True)

#Mengubah angka menjadi keterangan
day_df['bulan'] = day_df['bulan'].map({
    1: 'Jan', 2: 'Feb', 3: 'Mar', 4: 'Apr', 5: 'Mei', 6: 'Jun',
    7: 'Jul', 8: 'Agt', 9: 'Sep', 10: 'Okt', 11: 'Nov', 12: 'Des'
})

day_df['season'] = day_df['season'].map({
    1: 'Semi', 2: 'Panas', 3: 'Gugur', 4: 'Dingin'
})

day_df['workingday'] = day_df['workingday'].map({
    0: 'Hari libur', 1: 'Hari kerja'
})

day_df['cuaca'] = day_df['cuaca'].map({
    1: 'Cerah',
    2: 'Berawan',
    3: 'Hujan/salju ringan',
    4: 'Cuaca ekstrim'
})

#Mengelompokkan data berdasarkan musim
musiman = day_df.groupby('season').agg(
    total_peminjaman=('jumlah pengguna total', 'sum'),
    casual=('casual', 'sum'),
    registered=('registered', 'sum')
).reset_index()
musiman['proporsi_casual'] = musiman['casual'] / musiman['total_peminjaman']
musiman['proporsi_registered'] = musiman['registered'] / musiman['total_peminjaman']

st.title('Dashboard Analisis Data Peminjaman Sepeda Harian pada Tahun 2011-2012')

st.header('Data Peminjaman Sepeda Harian pada Tahun 2011-2012')
st.write(day_df)

#Plot Perbandingan Peminjam Casual dan Registered
st.header('Perbandingan Pengguna Casual dan Registered')
fig1, ax1 = plt.subplots()
ax1.bar(['Casual', 'Registered'], [musiman['casual'].sum(), musiman['registered'].sum()], color=['red', 'yellow'])
ax1.set_ylabel('Jumlah Pengguna')
ax1.set_title('Total Pengguna Casual Dibandingkan dengan Registered')
st.pyplot(fig1)

# Plot Proporsi Peminjaman Casual dan Registered
st.header('Perbandingan Pengguna Casual dan Registered pada Hari Kerja dan Hari Libur')
fig2, ax2 = plt.subplots()
ax2.bar(['Hari Kerja', 'Hari Libur'], [sum(day_df["workingday"] == "Hari kerja"), sum(day_df["workingday"] == "Hari libur")], color=['red', 'yellow'])
ax2.set_ylabel('Jumlah Pengguna')
ax2.set_title('Total Pengguna Casual dan Registered pada Hari Kerja Dibandingkan Hari Libur')
st.pyplot(fig2)

# Tambahkan copyright
st.caption('MarvinWijaya')